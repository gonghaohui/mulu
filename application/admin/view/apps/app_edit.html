{include file="public/header" /}
<body class="gray-bg">
<div class="layui-fluid layui-col-md12">
    <div class="layui-card">

        <div class="layui-card-header">
            <a style="background: #1E9FFF;padding: 5px 15px;color: #ffffff;" href="javascript:history.go(-1);">返回</a>
        </div>
        <div class="layui-card-header">修改APP</div>
        <div class="layui-card-body layui-form">
            <div class="layui-row layui-col-space10 layui-form-item ">
                <input type="hidden" id="id" name="id" value="{$app.id}">
                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>APP分类</label>
                    <div class="layui-input-block">
                        <select id="type" name="type" lay-verify="required">
                            <option value="1" {if $app.type== 1}selected="selected"{/if}>直播APP</option>
                            <option value="2" {if $app.type== 2}selected="selected"{/if}>体育APP</option>
                        </select>
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>是否显示</label>
                    <div class="layui-input-block">
                        <input type="radio" name="status" value="1" title="是" {if $app.status == 1}checked{/if}>
                        <input type="radio" name="status" value="0" title="否" {if $app.status == 0}checked{/if}>
                    </div>
                </div>
                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label">热门</label>
                    <div class="layui-input-block">
                        <input type="radio" name="hot" value="1" title="是" {if $app.hot == 1}checked{/if}>
                        <input type="radio" name="hot" value="0" title="否" {if $app.hot == 0}checked{/if}>
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label">排序(数字越小排越前面)</label>
                    <div class="layui-input-block">
                        <input type="number" class="layui-input" value="{$app.sort}" onkeyup="value=value.replace(/[^\d]/g,'')" autocomplete="off" name="sort" placeholder="排序(数字越小排越前面)">
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>APP名称</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input " id="name" name="name" value="{$app.name}" lay-verify="required" placeholder="APP名称">
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>APP副标题</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input " id="sub_name" name="sub_name" value="{$app.sub_name}" lay-verify="required" placeholder="APP副标题">
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label">APP图标</label>
                    <input type="hidden" name="img" value="{$app.img}" id="lay-img1" lay-verify="image" autocomplete="off">
                    <div class="layui-input-block">
                        <div id="lay-upload1" class="webuploader-container">
                            <div class="webuploader-pick">选择图片</div>
                            <div id="rt_rt_1fe5st5081mgk50u1r5q2t31h82n" style="position: absolute; inset: 0px auto auto 0px; width: 86px; height: 44px; overflow: hidden;">
                                <input type="file" name="file" class="webuploader-element-invisible" accept=".jpg"><label style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label>
                            </div>
                        </div>
                        <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">
                            预览图：
                            <div class="layui-upload-list" id="lay-img-list1">
                                {if !empty($app.img)}
                                <img class="layui-append-img" src="{$app.img}">
                                {/if}
                            </div>
                        </blockquote>
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md10">
                    <label class="layui-form-label">软件截图(多张)</label>
                    <div class="layui-input-block">
                        <input type="hidden" name="del" id="del" value="">
                        <input type="hidden" id="hid" value="{$app.photo}">
                        <input type="hidden" name="photo" id="photo" value="{$app.photo}">
                        <div id="uploader" class="container">
                            <div class="queueList">
                                <div class="placeholder">
                                    <div id="filePicker"></div>
                                    <p>或将照片拖到这里</p>
                                </div>
                            </div>
                            <div class="statusBar" style="display:none;">
                                <div class="layui-progress layui-progress-big active" lay-showpercent="true">
                                    <div class="layui-progress-bar layui-bg-blue" lay-percent="0%">
                                    </div>
                                    <span></span>
                                </div>
                                <div class="info"></div>
                                <div class="btns">
                                    <div id="goPicker" class="filePicker2"></div>
                                    <div class="uploadBtn">开始上传</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label">下载(多个请换行)</label>
                    <div class="layui-input-block">
                        <textarea name="downloads" class="layui-textarea" placeholder="广东电信下载|下载地址">{$app.downloads}</textarea>
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>APP应用大小</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input " id="size" name="size" value="{$app.size}" lay-verify="required" placeholder="APP应用大小">
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>APP应用平台</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input " id="platform" name="platform" value="{$app.platform}" lay-verify="required" placeholder="APP应用平台">
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>APP应用等级(最大5)</label>
                    <div class="layui-input-block">
                        <input type="number" class="layui-input " id="grade" value="4" name="grade" value="{$app.grade}" lay-verify="required" placeholder="APP应用等级">
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>APP应用版本</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input " id="version" name="version" value="{$app.version}" lay-verify="required" placeholder="APP应用版本">
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>APP应用语言</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input " id="language" name="language" value="{$app.language}" lay-verify="required" placeholder="APP应用语言">
                    </div>
                </div>

                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label"><em>*</em>APP更新时间</label>
                    <div class="layui-input-block">
                        <input type="text" class="layui-input " id="update" name="update" value="{$app.update}" lay-verify="required" placeholder="APP更新时间">
                    </div>
                </div>


                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label">软件详情</label>
                    <div class="layui-input-block">
                        <textarea name="detail" class="layui-textarea" placeholder="软件详情">{$app.detail}</textarea>
                    </div>
                </div>
                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label">软件介绍</label>
                    <div class="layui-input-block">
                        <textarea name="introduce" class="layui-textarea" placeholder="软件介绍">{$app.introduce}</textarea>
                    </div>
                </div>
                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label">软件功能</label>
                    <div class="layui-input-block">
                        <textarea name="function" class="layui-textarea" placeholder="软件功能">{$app.function}</textarea>
                    </div>
                </div>
                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label">软件亮点</label>
                    <div class="layui-input-block">
                        <textarea name="highlight" class="layui-textarea" placeholder="软件亮点">{$app.highlight}</textarea>
                    </div>
                </div>
                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <label class="layui-form-label">软件点评</label>
                    <div class="layui-input-block">
                        <textarea name="review" class="layui-textarea" placeholder="软件点评">{$app.review}</textarea>
                    </div>
                </div>


                <div class="layui-form-item layui-col-md-offset1 layui-col-md8">
                    <div class="layui-input-block">
                        <button class="layui-btn" lay-submit="" lay-filter="component-form-element">保存
                        </button>
                        <button class="layui-btn layui-btn-primary" onclick="history.back()">关闭</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{include file="public/footer" /}

<link rel="stylesheet" type="text/css" href="__JS__/flatpickr/flatpickr.min.css">
<script>

    // var n = wk.uploads({num:8,type:'png,jpg,gif',status:'update'})
    var n = wk.uploads({num:10,type:'png,jpg,gif',status:'update',url:"{:url('admin/upload/uploadLocality')}"});
    function imgDel(e,obj,hid,del){
        wk.update_del(e,obj,hid,del,n);
    }

</script>
<script>
    wk.uploadImg({size:5,num:1,type:'jpg,png',url:"{:url('Upload/uploadLocality')}"});



    $("#update").flatpickr({         //初始化插件
        // shorthandCurrentMonth:true
    });


    layui.use(['form','upload','layedit','element'], function() {
        var form = layui.form;

        form.on('submit(component-form-element)', function (data) {
            // var content = UE.getEditor('LAY_editor2').getContent();
            // data.field.content = content;
            $('.layui-btn').addClass('layui-disabled').attr('disabled','disabled');
            $.ajax({
                url:"{:url('edit_app')}",
                type:'post',
                dataType:'json',
                data:data.field,
                success:function(res){
                    if (res.code == 200) {
                        layer.msg(res.msg,{icon:1,time:1500,shade:0.1},function(index){
                            // wk.layer_close();
                            window.location.href="{:url('app_list')}";
                        })
                    } else {
                        $(".layui-btn").removeClass('layui-disabled').removeAttr('disabled');
                        wk.error(res.msg);
                        return false;
                    }
                }
            })
        });
    });


</script>
</body>
</html>